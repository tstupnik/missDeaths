summary(x)
mean(x)
min(x)
max(x)
ggsurvplot(pfs, data = meso,
conf.int = T
break.y.by = 0.1,
ylim= c(0,1),
xlab = "Years",   # customize X axis label.
ylab = "PFS")
pfs = survfit(Surv((pdate-itdate)/365, pstatus) ~ line, data = meso)
summary(pfs)
ggsurvplot(pfs, data = meso,
conf.int = T,
break.y.by = 0.1,
ylim= c(0,1),
xlab = "Years",   # customize X axis label.
ylab = "PFS")
library(gtsummary)
install.packages("gtsummary")
install.packages("gtsummary")
install.packages("gtsummary")
library(survival)
library(survminer)
library(devtools)
library(ggplot2)
library(zoo)
library(readxl)
library(gg3D)
library(plotly)
library(gtsummary)
library(survival)
library(survminer)
library(devtools)
library(ggplot2)
library(zoo)
library(readxl)
library(gg3D)
library(plotly)
library(gtsummary)
library(survival)
library(survminer)
library(devtools)
library(ggplot2)
library(survival)
library(survminer)
library(devtools)
library(ggplot2)
library(zoo)
library(readxl)
library(gg3D)
library(plotly)
library(gtsummary)
install.packages("gtsummary", dependencies = FALSE)
install.packages("knitr", dependencies = FALSE)
install.packages("xfun", dependencies = FALSE)
tbl_survfit
pfs = survfit(Surv((pdate-itdate)/365, pstatus) ~ line, data = meso, times=365)
summary(pfs, times=365)
pfs = survfit(Surv((pdate-itdate)/365, pstatus) ~ line, data = meso)
summary(pfs, times=365)
pfs = survfit(Surv((pdate-itdate)/365, pstatus) ~ line, data = meso)
summary(pfs)
ggsurvplot(pfs, data = meso,
conf.int = T,
break.y.by = 0.1,
ylim= c(0,1),
xlab = "Years",   # customize X axis label.
ylab = "PFS")
summary(pfs, times=365)
summary(pfs, times=1)
os = survfit(Surv((ddate-diagn)/365, dstatus) ~ line, data = meso)
summary(os, 1)
ggsurvplot(os, data = meso,
break.y.by = 0.1,
ylim= c(0,1),
xlab = "Years",   # customize X axis label.
ylab = "OS")
os = survfit(Surv((ddate-diagn)/365, dstatus) ~ line, data = meso)
summary(os, 2)
ggsurvplot(os, data = meso,
break.y.by = 0.1,
ylim= c(0,1),
xlab = "Years",   # customize X axis label.
ylab = "OS")
os = survfit(Surv((ddate-diagn)/365, dstatus) ~ line, data = meso)
summary(os, 2)
ggsurvplot(os, data = meso,
break.y.by = 0.1,
ylim= c(0,1),
xlab = "Years",   # customize X axis label.
ylab = "OS")
summary(pfs)
survdiff(Surv((pdate-itdate)/365, pstatus) ~ line, data = meso)
survdiff(Surv((ddate-diagn)/365, dstatus) ~ line, data = meso)
library(readxl)
pacienti <- read_excel("C:/Users/tomaz/Desktop/pacienti.xlsx")
View(pacienti)
fit = survfit(Surv(time, status) ~ 1, data = pacienti)
summary(fit)
fit = survfit(Surv(time, status) ~ 1, data = pacienti)
summary(fit)
fit = survfit(Surv(time, status) ~ 1, data = pacienti)
library(survival)
library(survminer)
library(devtools)
library(ggplot2)
library(zoo)
library(readxl)
library(gg3D)
library(plotly)
fit = survfit(Surv(time, status) ~ 1, data = pacienti)
summary(fit)
ggsurvplot(fit, data = pacienti,
break.y.by = 0.1,
ylim= c(0.7,1),
xlab = "Years",   # customize X axis label.
ylab = "Survival")
fit = survfit(Surv(time, status) ~ 1, data = pacienti)
summary(fit)
ggsurvplot(fit, data = pacienti,
break.y.by = 0.1,
ylim= c(0,1),
xlab = "Years",   # customize X axis label.
ylab = "Survival")
fit = survfit(Surv(time, status) ~ 1, data = pacienti)
summary(fit)
ggsurvplot(fit, data = pacienti,
break.y.by = 0.1,
ylim= c(0,1),
xlim=c(0,5)
xlab = "Years",   # customize X axis label.
ylab = "Survival")
ggsurvplot(fit, data = pacienti,
break.y.by = 0.1,
ylim= c(0,1),
xlim=c(0,5),
xlab = "Years",   # customize X axis label.
ylab = "Survival")
fit = survfit(Surv(time, !status) ~ 1, data = pacienti)
summary(fit)
ggsurvplot(fit, data = pacienti,
break.y.by = 0.1,
ylim= c(0,1),
xlim=c(0,5),
xlab = "Years",   # customize X axis label.
ylab = "Survival")
summary(fit)
fit = survfit(Surv(time, !status) ~ 1, data = pacienti)
summary(fit)
ggsurvplot(fit, data = pacienti,
break.y.by = 0.1,
ylim= c(0,1),
xlim=c(0,5),
xlab = "Years",   # customize X axis label.
ylab = "Survival",
risk.table = TRUE)
summary(fit)
ggsurvplot(fit, data = pacienti,
break.y.by = 0.1,
break.x.by = 0.5,
ylim= c(0,1),
xlim=c(0,5),
xlab = "Years",   # customize X axis label.
ylab = "Survival",
risk.table = TRUE)
fit = survfit(Surv(time, !status) ~ 1, data = pacienti)
summary(fit)
ggsurvplot(fit, data = pacienti,
break.y.by = 0.2,
break.x.by = 1,
ylim= c(0,1),
xlim=c(0,4.5),
xlab = "Years",   # customize X axis label.
ylab = "Survival",
risk.table = TRUE)
fit = survfit(Surv(time, !status) ~ 1, data = pacienti)
summary(fit)
ggsurvplot(fit, data = pacienti,
break.y.by = 0.2,
break.x.by = 1,
ylim= c(0.2,1),
xlim=c(0,4.5),
xlab = "Years",   # customize X axis label.
ylab = "Survival",
risk.table = TRUE)
survival <- read_excel("C:/Users/tomaz/Documents/Thorax/Documents/Articles/krajnc marija/survival.xlsx",
range = "A1:AB52",
col_types = c("numeric", "text", "date", "date","text",
"date", "numeric", "date", "numeric", "numeric", "text", "numeric", "numeric",
"numeric", "numeric", "text", "text", "numeric", "numeric", "numeric", "numeric",
"numeric", "text", "numeric", "numeric", "numeric", "numeric", "numeric"))
fit = survfit(Surv((Date-LuTX)/365, Status) ~ 1, data = survival)
summary(fit)
ggsurvplot(fit, data = survival,
break.y.by = 0.1,
ylim= c(0.7,1),
xlab = "Years",   # customize X axis label.
ylab = "Survival")
d=as.data.frame(table(survival$dg))
d$Freq = d$Freq/47
d
library(foreign)
df <- read.spss("C:/Users/tomaz/Documents/Thorax/Power Point/presaditev pljuc/apr2021.sav", use.value.label=TRUE, to.data.frame=TRUE)
library(survival)
library(survminer)
library(devtools)
library(ggplot2)
library(zoo)
library(readxl)
library(gg3D)
library(plotly)
byday <- read_excel("C:/Users/tomaz/Documents/Thorax/Documents/Articles/krajnc marija/byday.xlsx",
col_types = c("numeric", "numeric", "numeric", "numeric",
"numeric", "numeric", "numeric", "numeric"))
txhours = array(0,c(1,3))
for (i in 2:8)
{
for (j in 1:24)
{
if (!is.na(byday[j,i]))
{
for (k in 1:as.numeric(byday[j,i]))
{
for (l in 0:0)
{
t = array(c(i,(j+l),1),c(1,3))
txhours = rbind(txhours, t)
}
}
}
}
}
txhours = txhours[-1,]
txhours[,2] = txhours[,2] %% 24
txhours = data.frame(weekday=txhours[,1], hour=txhours[,2], count=txhours[,3])
hh=txhours %>% group_by(hour) %>% summarise(sum=sum(count))
ggplot(data=hh, aes(x=hour, y=(sum-mean(hh$sum))/36)) +
geom_bar(stat="identity")
dd=txhours %>% group_by(weekday) %>% summarise(sum=sum(count)/36/7)
ggplot(data=dd, aes(x=weekday-1, y=sum)) +
geom_bar(stat="identity")
#survival <- read_excel("C:/Users/tomaz/Desktop/lobarne presaditve/survival.xlsx",
#                       col_types = c("numeric", "text", "date", "date",
#                                     "date", "numeric", "numeric", "text"))
survival <- read_excel("C:/Users/tomaz/Documents/Thorax/Documents/Articles/krajnc marija/survival.xlsx",
range = "A1:AB52",
col_types = c("numeric", "text", "date", "date","text",
"date", "numeric", "date", "numeric", "numeric", "text", "numeric", "numeric",
"numeric", "numeric", "text", "text", "numeric", "numeric", "numeric", "numeric",
"numeric", "text", "numeric", "numeric", "numeric", "numeric", "numeric"))
fit = survfit(Surv((Date-LuTX)/365, Status) ~ 1, data = survival)
summary(fit)
ggsurvplot(fit, data = survival,
break.y.by = 0.1,
ylim= c(0.7,1),
xlab = "Years",   # customize X axis label.
ylab = "Survival")
d=as.data.frame(table(survival$dg))
d$Freq = d$Freq/47
d
View(survival)
View(survival)
survival$dg
summary(survival$dg)
sum(survival$dg=="copd")
sum(survival$dg=="COPD")
sum(survival$dg=="IPF")
sum(survival$dg=="PAH")
sum(survival$dg=="CF")
survival$Date-survival$Birth
(survival$Date-survival$Birth)
(survival$Date-survival$Birth)/365
median((survival$Date-survival$Birth)/365)
median((survival$LuTX-survival$Birth)/365)
mein((survival$LuTX-survival$Birth)/365)
min((survival$LuTX-survival$Birth)/365)
max((survival$LuTX-survival$Birth)/365)
library(survival)
library(survminer)
library(devtools)
library(ggplot2)
library(zoo)
library(readxl)
library(gg3D)
library(plotly)
byday <- read_excel("C:/Users/tomaz/Documents/Thorax/Documents/Articles/krajnc marija/byday.xlsx",
col_types = c("numeric", "numeric", "numeric", "numeric",
"numeric", "numeric", "numeric", "numeric"))
txhours = array(0,c(1,3))
for (i in 2:8)
{
for (j in 1:24)
{
if (!is.na(byday[j,i]))
{
for (k in 1:as.numeric(byday[j,i]))
{
for (l in 0:0)
{
t = array(c(i,(j+l),1),c(1,3))
txhours = rbind(txhours, t)
}
}
}
}
}
txhours = txhours[-1,]
txhours[,2] = txhours[,2] %% 24
txhours = data.frame(weekday=txhours[,1], hour=txhours[,2], count=txhours[,3])
hh=txhours %>% group_by(hour) %>% summarise(sum=sum(count))
ggplot(data=hh, aes(x=hour, y=(sum-mean(hh$sum))/36)) +
geom_bar(stat="identity")
dd=txhours %>% group_by(weekday) %>% summarise(sum=sum(count)/36/7)
ggplot(data=dd, aes(x=weekday-1, y=sum)) +
geom_bar(stat="identity")
#survival <- read_excel("C:/Users/tomaz/Desktop/lobarne presaditve/survival.xlsx",
#                       col_types = c("numeric", "text", "date", "date",
#                                     "date", "numeric", "numeric", "text"))
survival <- read_excel("C:/Users/tomaz/Documents/Thorax/Documents/Articles/krajnc marija/survival.xlsx",
range = "A1:AB52",
col_types = c("numeric", "text", "date", "date","text",
"date", "numeric", "date", "numeric", "numeric", "text", "numeric", "numeric",
"numeric", "numeric", "text", "text", "numeric", "numeric", "numeric", "numeric",
"numeric", "text", "numeric", "numeric", "numeric", "numeric", "numeric"))
fit = survfit(Surv((Date-LuTX)/365, Status) ~ 1, data = survival)
summary(fit)
ggsurvplot(fit, data = survival,
break.y.by = 0.1,
ylim= c(0.7,1),
xlab = "Years",   # customize X axis label.
ylab = "Survival")
d=as.data.frame(table(survival$dg))
d$Freq = d$Freq/47
d
ggsurvplot(
fit,                     # survfit object with calculated statistics.
data = survival,             # data used to fit survival curves.
risk.table = TRUE,       # show risk table.
conf.int = TRUE,         # show confidence intervals for
# point estimates of survival curves.
xlim = c(0,3.5),         # present narrower X axis, but not affect
ylim= c(0.5,1),
# survival estimates.
xlab = "Years",   # customize X axis label.
ylab = "Survival",
break.time.by = 0.25,     # break X axis in time intervals by 500.
break.y.by = 0.05,
ggtheme = theme_light(), # customize plot and risk table with a theme.
color="red",
fontsize = 4,
risk.table.height = 0.2,
risk.table.y.text.col = T, # colour risk table text annotations.
risk.table.y.text = FALSE # show bars instead of names in text annotations
# in legend of risk table
)
listed = as.Date(survival$Listed)
lutx = as.Date(survival$LuTX)
LAS = survival$LAS
waiting = rbind(cbind(listed,1,LAS), cbind(lutx,-1,LAS))
o = order(waiting[,1])
waiting = waiting[o,]
waiting = cbind(waiting,cumsum(waiting[,2]))
waiting = waiting[which(!is.na(waiting[,1])),]
waiting = rbind(waiting, waiting[dim(waiting)[1],])
waiting[,1]=waiting[,1]/365.24+1970
waiting = waiting[3:dim(waiting)[1]-1,]
prev = 33.3*2
for (i in 1:dim(waiting)[1])
{
prev = (prev + waiting[i,3] * waiting[i,2])
waiting[i,3] = prev/(waiting[i,4]+1)
}
waiting = data.frame(date=waiting[,1], count=waiting[,4], LAS=waiting[,3])
waiting = rbind(waiting, waiting[dim(waiting)[1],])
waiting$date[dim(waiting)[1]] = 2021
deaths = data.frame(date=c(as.Date("2019-9-19")), count=9)
deaths[,1] = as.numeric(deaths[,1])/365.24+1970
transplants = data.frame(date=c(as.Date(lutx)))[1:28,]
transplants = as.numeric(transplants)/365.24+1970
count = transplants
for (i in 1:length(transplants))
{
count[i] = 1+min(waiting$count[which(waiting$date==transplants[i])])
}
transplants = data.frame(date=transplants, count=count)
covid = waiting[61,]
waiting = waiting[which(waiting$date>=2018.97),]
ggplot() + theme_light() +
geom_step(data=waiting, mapping=aes(x=date, count), size = 0.75, color="black") +
geom_point(data=transplants, mapping=aes(x=date, y=count), size = 4, color="black") +
geom_point(data=deaths, shape=25, mapping=aes(x=date, y=count), size = 4, fill="red", color="black") +
geom_point(data=covid, shape=21, mapping=aes(x=date, y=count+1), size = 4, fill="red", color="black") +
scale_y_continuous(name="", breaks=c(1:10))+
scale_x_continuous(name="", breaks=c(2019:2021), limits = c(2018.97, 2021)) +
theme(axis.text.x = element_text(face="bold", color="#000000",
size=14, angle=0),
axis.text.y = element_text(face="bold", color="#000000",
size=14, angle=0)
)
theme <- theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_line(colour = "gray98"),
panel.grid.minor = element_line(colour = "gray98"),
panel.border = element_blank(),
panel.background = element_blank())
survival <- read_excel("C:/Users/tomaz/Documents/Thorax/Documents/Articles/krajnc marija/harlydata.xlsx",
col_types = c("text", "date", "date", "numeric", "date",
"numeric", "date", "numeric", "numeric", "numeric"))
survival = survival[which(survival$center<3),]
fit = survfit(Surv((Date-LuTX)/365, Status) ~ center, data = survival)
summary(fit)
ggsurvplot(fit, data = survival,
size = 1,                 # change line size
#palette = "Dark2",
#palette = c("#E7B800", "#2E9FDF"),
palette = c("#1C73C2","red"),
ggtheme = theme, # theme_bw()
conf.int = FALSE,          # Add confidence interval
pval = TRUE,              # Add p-value
fontsize = 4,
break.y.by = 0.1,
ylim = c(0.7,1),
xlim = c(0, 7),
break.time.by = 0.5,
xlab = "Years",   # customize X axis label.
ylab = "Survival",
risk.table = TRUE
)
trunc = survival
times = (trunc$Date - trunc$LuTX)/365
for (i in 1:length(times))
{
limit = 2
times[i] = as.numeric(times[i])
if (trunc$Status[i] == 1)
if (times[i] > limit)
trunc$Status[i] = 0
if (times[i] > limit)
times[i] = limit
}
trunc$time = times
fit = survfit(Surv(time, Status) ~ center, data = trunc)
summary(fit)
plot(fit)
ggsurvplot(fit, data = trunc,
pval = TRUE)
d=as.data.frame(table(survival$dg))
d$Freq = d$Freq/28*100
d
ggsurvplot(fit, data = survival,
size = 1,                 # change line size
#palette = "Dark2",
#palette = c("#E7B800", "#2E9FDF"),
palette = c("#1C73C2","red"),
ggtheme = theme, # theme_bw()
conf.int = FALSE,          # Add confidence interval
pval = TRUE,              # Add p-value
fontsize = 4,
break.y.by = 0.1,
ylim = c(0.7,1),
xlim = c(0, 7),
break.time.by = 0.5,
xlab = "Years",   # customize X axis label.
ylab = "Survival",
risk.table = TRUE
)
survival <- read_excel("C:/Users/tomaz/Documents/Thorax/Documents/Articles/krajnc marija/harlydata.xlsx",
col_types = c("text", "date", "date", "numeric", "date",
"numeric", "date", "numeric", "numeric", "numeric"))
survival = survival[which(survival$center<3),]
fit = survfit(Surv((Date-LuTX)/365, Status) ~ center, data = survival)
summary(fit)
ggsurvplot(fit, data = survival,
size = 1,                 # change line size
#palette = "Dark2",
#palette = c("#E7B800", "#2E9FDF"),
palette = c("#1C73C2","red"),
ggtheme = theme, # theme_bw()
conf.int = FALSE,          # Add confidence interval
pval = TRUE,              # Add p-value
fontsize = 4,
break.y.by = 0.1,
ylim = c(0.7,1),
xlim = c(0, 7),
break.time.by = 0.5,
xlab = "Years",   # customize X axis label.
ylab = "Survival",
risk.table = TRUE
)
survival <- read_excel("C:/Users/tomaz/Documents/Thorax/Documents/Articles/krajnc marija/harlydata.xlsx",
col_types = c("text", "date", "date", "numeric", "date",
"numeric", "date", "numeric", "numeric", "numeric"))
survival = survival[which(survival$center<3),]
fit = survfit(Surv((Date-LuTX)/365, Status) ~ center, data = survival)
summary(fit)
ggsurvplot(fit, data = survival,
size = 1,                 # change line size
#palette = "Dark2",
#palette = c("#E7B800", "#2E9FDF"),
palette = c("#1C73C2","red"),
ggtheme = theme, # theme_bw()
conf.int = FALSE,          # Add confidence interval
pval = TRUE,              # Add p-value
fontsize = 4,
break.y.by = 0.1,
ylim = c(0.7,1),
xlim = c(0, 7),
break.time.by = 0.5,
xlab = "Years",   # customize X axis label.
ylab = "Survival",
risk.table = TRUE
)
